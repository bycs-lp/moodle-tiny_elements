{"version":3,"file":"management.min.js","sources":["../src/management.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Management functions for tiny_elements admin backend.\n *\n * @module     tiny_elements/management\n * @copyright  2024 ISB Bayern\n * @author     Tobias Garske\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {PreviewModal} from 'tiny_elements/previewmodal';\nimport ModalForm from 'core_form/modalform';\nimport Notification from 'core/notification';\nimport {get_string as getString} from 'core/str';\nimport {exception as displayException, deleteCancelPromise} from 'core/notification';\nimport {call as fetchMany} from 'core/ajax';\nimport {render as renderTemplate} from 'core/templates';\nimport Log from 'core/log';\n\nexport const init = async(params) => {\n\n    // Add listener to import xml files.\n    let importxml = document.getElementById('elements_import');\n    importxml.addEventListener('click', async(e) => {\n        importModal(e);\n    });\n\n    // Add listener for adding a new item.\n    let additem = document.getElementsByClassName('add');\n    additem.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            showModal(e, element.dataset.id, element.dataset.table);\n        });\n    });\n\n    // Add listener to edit items.\n    let edititems = document.getElementsByClassName('edit');\n    edititems.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            showModal(e, element.dataset.id, element.dataset.table);\n        });\n    });\n\n    // Add listener to delete items.\n    let deleteitems = document.getElementsByClassName('delete');\n    deleteitems.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            deleteModal(e, element.dataset.id, element.dataset.title, element.dataset.table);\n        });\n    });\n\n    // Add listener to preview items.\n    let previewitems = document.getElementsByClassName('preview-button');\n    previewitems.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            previewModal(e);\n        });\n    });\n\n    // Add listener to select compcat to show corresponding items.\n    let compcats = document.getElementsByClassName('compcat');\n    compcats.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            showItems(e, element.dataset.compcat);\n        });\n    });\n\n    // Add listener to edit licenses of icons.\n    let editlicenses = document.querySelectorAll('.editlicenses');\n    editlicenses.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            editlicensesModal(e, element.dataset.id);\n        });\n    });\n\n    // Add listener to manage component flavor relation.\n    let buttonicons = document.querySelectorAll('.buttonicons');\n    buttonicons.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            compflavorModal(e);\n        });\n    });\n\n    let displaynamesbutton = document.getElementById('elements_displaynames_button');\n    displaynamesbutton.addEventListener('click', async(e) => {\n        displaynamesModal(e);\n    });\n\n    let displaynamesflavorbutton = document.getElementById('elements_displaynames_flavor_button');\n    displaynamesflavorbutton.addEventListener('click', async(e) => {\n        displaynamesFlavorModal(e);\n    });\n\n    let displaynamesvariantbutton = document.getElementById('elements_displaynames_variant_button');\n    displaynamesvariantbutton.addEventListener('click', async(e) => {\n        displaynamesVariantModal(e);\n    });\n\n    // Add listener to duplicate items.\n    let duplicateitems = document.getElementsByClassName('duplicate');\n    duplicateitems.forEach(element => {\n        element.addEventListener('click', async() => {\n            duplicateItem(element.dataset.id, element.dataset.table).always(() => reload());\n        });\n    });\n\n    // Add listener to wipe all items.\n    let wipebutton = document.getElementById('elements_wipe');\n    if (wipebutton) {\n        wipebutton.addEventListener('click', async(e) => {\n            wipeModal(e);\n        });\n    }\n\n    // Add image and text to item setting click area.\n    let enlargeItems = document.querySelectorAll(\n        '.flavor .card-body > .clickingextended, .component .card-body > .clickingextended, .variant .card-body > .clickingextended'\n    );\n    enlargeItems.forEach(element => {\n        element.addEventListener('click', async(e) => {\n            let item = e.target.closest('.item');\n            item.querySelector('a.edit').click();\n        });\n    });\n\n    // After submitting a new item, reset active compcat.\n    if (params.compcatactive) {\n        let compcat = document.querySelector('.compcat[data-compcat=\"' + params.compcatactive + '\"]');\n        if (compcat) {\n            showItems(false, params.compcatactive);\n            compcat.classList.add('active');\n        }\n    }\n};\n\n/**\n * Show dynamic form to add/edit a source.\n * @param {*} event\n * @param {*} id\n * @param {*} table\n */\nconst showModal = async(event, id, table) => {\n    event.preventDefault();\n    let title;\n    if (id == 0) {\n        title = getString('additem', 'tiny_elements');\n    } else {\n        title = getString('edititem', 'tiny_elements');\n    }\n\n    const modalForm = new ModalForm({\n        // Set formclass, depending on component.\n        formClass: \"tiny_elements\\\\form\\\\management_\" + table + \"_form\",\n        args: {\n            id: id,\n            compcat: getActiveCompcatId(),\n            categoryname: getActiveCompcatName(),\n        },\n        modalConfig: {title: title},\n        returnFocus: event.target,\n    });\n    // Conditional reload page after submit.\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, () => reload());\n\n    await modalForm.show();\n};\n\n/**\n * Show modal to preview css version.\n * @param {*} event\n */\nconst previewModal = async(event) => {\n    event.preventDefault();\n    let preview = event.target.closest(\".preview-button\");\n    const modal = await PreviewModal.create({\n        templateContext: {\n            component: preview.dataset.component,\n            flavors: preview.dataset.flavors.trim().split(\" \"),\n            config: M.cfg,\n        },\n    });\n    await modal.show();\n};\n\n/**\n * Show dynamic form to import xml backups.\n * @param {*} event\n */\nconst importModal = async(event) => {\n    event.preventDefault();\n    let title = getString('import', 'tiny_elements');\n\n    const modalForm = new ModalForm({\n        // Load import form.\n        formClass: \"tiny_elements\\\\form\\\\management_import_form\",\n        args: {},\n        modalConfig: {title: title},\n    });\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, importModalSubmitted);\n\n    await modalForm.show();\n};\n\n/**\n * Process import form submit.\n * @param {*} event\n */\nconst importModalSubmitted = async(event) => {\n    // Reload page after submit.\n    if (event.detail.update) {\n        location.reload();\n    } else {\n        event.stopPropagation();\n        renderTemplate('tiny_elements/management_import_form_result', event.detail).then(async(html) => {\n            await Notification.alert(\n                getString('import_simulation', 'tiny_elements'),\n                html,\n                getString('close', 'tiny_elements')\n            );\n            return true;\n        }).catch((error) => {\n            displayException(error);\n        });\n    }\n};\n\n/**\n * Load modal to edit icon urls.\n * @param {*} event\n */\nconst compflavorModal = async(event) => {\n    event.preventDefault();\n    let title = getString('manage', 'tiny_elements');\n    const target = event.target.closest('.buttonicons');\n    const component = target.dataset.component ?? '';\n    const flavor = target.dataset.flavor ?? '';\n    const modalForm = new ModalForm({\n        // Load import form.\n        formClass: \"tiny_elements\\\\form\\\\management_comp_flavor_form\",\n        args: {\n            component: component,\n            flavor: flavor,\n        },\n        modalConfig: {title: title},\n    });\n\n    await modalForm.show();\n};\n\n/**\n * Load modal to edit licenses of icons.\n * @param {*} e\n * @param {*} id\n */\nfunction editlicensesModal(e, id) {\n    e.preventDefault();\n    let title = getString('editlicenses', 'tiny_elements');\n    const modalForm = new ModalForm({\n        formClass: \"tiny_elements\\\\form\\\\management_editlicense_form\",\n        args: {\n            id: id,\n        },\n        modalConfig: {title: title},\n    });\n    modalForm.show();\n}\n\n/**\n * Load modal to edit displaynames.\n * @param {*} event\n * @returns {void}\n */\nconst displaynamesModal = async(event) => {\n    event.preventDefault();\n    let title = getString('manage', 'tiny_elements');\n\n    const modalForm = new ModalForm({\n        // Load displaynames bulk edit form.\n        formClass: \"tiny_elements\\\\form\\\\management_displaynames_form\",\n        args: {},\n        modalConfig: {title: title},\n    });\n\n    // Reload page after submit.\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, () => location.reload());\n\n    await modalForm.show();\n};\n\n/**\n * Load modal to edit displaynames.\n * @param {*} event\n * @returns {void}\n */\nconst displaynamesFlavorModal = async(event) => {\n    event.preventDefault();\n    let title = getString('manage', 'tiny_elements');\n\n    const modalForm = new ModalForm({\n        // Load displaynames bulk edit form.\n        formClass: \"tiny_elements\\\\form\\\\management_displaynames_flavors_form\",\n        args: {},\n        modalConfig: {title: title},\n    });\n\n    // Reload page after submit.\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, () => location.reload());\n\n    await modalForm.show();\n};\n\n/**\n * Load modal to edit displaynames.\n * @param {*} event\n * @returns {void}\n */\nconst displaynamesVariantModal = async(event) => {\n    event.preventDefault();\n    let title = getString('manage', 'tiny_elements');\n\n    const modalForm = new ModalForm({\n        // Load displaynames bulk edit form.\n        formClass: \"tiny_elements\\\\form\\\\management_displaynames_variants_form\",\n        args: {},\n        modalConfig: {title: title},\n    });\n\n    // Reload page after submit.\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, () => location.reload());\n\n    await modalForm.show();\n};\n\n/**\n * Show dynamic form to delete a source.\n * @param {*} event\n * @param {*} id\n * @param {*} title\n * @param {*} table\n */\nconst deleteModal = (event, id, title, table) => {\n    event.preventDefault();\n\n    deleteCancelPromise(\n        getString('delete', 'tiny_elements', title),\n        getString('deletewarning', 'tiny_elements'),\n    ).then(async() => {\n        if (id !== 0) {\n            try {\n                const deleted = await deleteItem(id, table);\n                if (deleted) {\n                    const link = document.querySelector('[data-table=\"' + table + '\"][data-id=\"' + id + '\"]');\n                    if (link) {\n                        const card = link.closest(\".item\");\n                        card.remove();\n                    }\n                }\n            } catch (error) {\n                displayException(error);\n            }\n        }\n        return;\n    }).catch((err) => {\n        if (err.message) {\n            Log.error(err.message);\n        }\n        return;\n    });\n};\n\n/**\n * Show a modal to confirm wiping all items.\n * @param {*} event\n */\nconst wipeModal = (event) => {\n    event.preventDefault();\n\n    deleteCancelPromise(\n        getString('wipe', 'tiny_elements'),\n        getString('wipewarning', 'tiny_elements')\n    ).then(async() => {\n        try {\n            await wipe();\n            reload();\n        } catch (error) {\n            displayException(error);\n        }\n    }).catch((err) => {\n        if (err.message) {\n            Log.error(err.message);\n        }\n        return;\n    });\n};\n\n/**\n * Delete elements items.\n * @param {*} id\n * @param {*} table\n * @returns {mixed}\n */\nexport const deleteItem = (\n    id,\n    table,\n) => fetchMany(\n    [{\n        methodname: 'tiny_elements_delete_item',\n        args: {\n            id,\n            table,\n        }\n    }])[0];\n\n/**\n * Wipe all elements items.\n * @returns {mixed}\n */\nexport const wipe = () => fetchMany(\n    [{\n        methodname: 'tiny_elements_wipe',\n        args: {\n            \"contextid\": 1,\n        }\n    }])[0];\n\n/**\n * Show items after clicking a compcat.\n * @param {*} event\n * @param {*} compcat\n */\nconst showItems = (event, compcat) => {\n    // But first hide all items.\n    let itemsHide = document.querySelectorAll('.flavor, .component, .variant');\n    itemsHide.forEach(element => {\n        element.classList.add('hidden');\n    });\n\n    // Show component and variants with compcat name and read the flavors.\n    let itemsShow = document.querySelectorAll('[data-categoryname=\"' + compcat + '\"]');\n    let usedFlavors = [];\n    itemsShow.forEach(element => {\n        element.classList.remove('hidden');\n        // Get all flavors to show if on compcat element.\n        if (typeof element.dataset.flavors !== 'undefined') {\n            let flavors = element.dataset.flavors.split(' ');\n            for (let value of flavors) {\n                if (!usedFlavors.includes(value) && value.length != 0) {\n                    usedFlavors.push(value);\n                }\n            }\n        }\n    });\n\n    // Show the flavors.\n    let flavorstring = usedFlavors.map(item => `.${item}`).join(', ');\n    if (flavorstring.length) {\n        let flavorsShow = document.querySelectorAll(flavorstring);\n        flavorsShow.forEach(element => {\n            element.classList.remove('hidden');\n        });\n    }\n\n    // Show add buttons.\n    let addsShow = document.getElementsByClassName('addcontainer');\n    addsShow.forEach(element => {\n        element.classList.remove('hidden');\n    });\n\n    // Unmark all and mark clicked compcat.\n    if (event) {\n        let items = document.getElementsByClassName('compcat');\n        items.forEach(element => {\n            element.classList.remove('active');\n        });\n        let item = event.target.closest('.compcat');\n        item.classList.add('active');\n    }\n\n    // Special case, unassigned items, show all items without connection to compcat.\n    if (compcat == 'found-items') {\n        let found = document.querySelector('.compcat[data-compcat=\"found-items\"]');\n        if (found.dataset.loneflavors.length) {\n            let flavorsShow = document.querySelectorAll(found.dataset.loneflavors);\n            flavorsShow.forEach(element => {\n                element.classList.remove('hidden');\n            });\n        }\n        if (found.dataset.lonevariants.length) {\n            let variantsShow = document.querySelectorAll(found.dataset.lonevariants);\n            variantsShow.forEach(element => {\n                element.classList.remove('hidden');\n            });\n        }\n        if (found.dataset.lonecomponents.length) {\n            let componentsShow = document.querySelectorAll(found.dataset.lonecomponents);\n            componentsShow.forEach(element => {\n                element.classList.remove('hidden');\n            });\n        }\n    }\n};\n\n/**\n * Reload page with active compcat.\n */\nconst reload = () => {\n    // Reload page with active compcat.\n    const currentUrl = new URL(window.location.href);\n    currentUrl.searchParams.set('compcat', getActiveCompcatName());\n    window.location.href = currentUrl.toString();\n    window.location.reload();\n};\n\n/**\n * Get the current active compcat.\n * @returns string Name of active compcat.\n */\nconst getActiveCompcatName = () => {\n    const compcat = document.querySelector('.compcat.active');\n    if (!compcat) {\n        return '';\n    }\n    return compcat.dataset.compcat ?? '';\n};\n\n/**\n * Get the current active compcat.\n * @returns int Id of active compcat.\n */\nconst getActiveCompcatId = () => {\n    const compcat = document.querySelector('.compcat.active');\n    if (!compcat) {\n        return 0;\n    }\n    return compcat.dataset.id ?? 0;\n};\n\n/**\n * Duplicate elements items.\n * @param {*} id\n * @param {*} table\n * @returns {mixed}\n */\nexport const duplicateItem = (id, table) => fetchMany(\n    [{\n        methodname: 'tiny_elements_duplicate_item',\n        args: {\n            id,\n            table,\n        }\n    }])[0];\n"],"names":["async","document","getElementById","addEventListener","importModal","e","getElementsByClassName","forEach","element","showModal","dataset","id","table","deleteModal","title","previewModal","showItems","compcat","querySelectorAll","preventDefault","ModalForm","formClass","args","modalConfig","show","editlicensesModal","compflavorModal","displaynamesModal","displaynamesFlavorModal","displaynamesVariantModal","duplicateItem","always","reload","wipebutton","wipeModal","target","closest","querySelector","click","params","compcatactive","classList","add","event","modalForm","getActiveCompcatId","categoryname","getActiveCompcatName","returnFocus","events","FORM_SUBMITTED","preview","modal","PreviewModal","create","templateContext","component","flavors","trim","split","config","M","cfg","importModalSubmitted","detail","update","location","stopPropagation","then","Notification","alert","html","catch","error","flavor","deleteItem","link","remove","err","message","wipe","methodname","itemsShow","usedFlavors","value","includes","length","push","flavorstring","map","item","join","found","loneflavors","lonevariants","lonecomponents","currentUrl","URL","window","href","searchParams","set","toString"],"mappings":"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"}